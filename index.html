<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Solicitud de Alta de VPN</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=Libre+Franklin:wght@500;700&display=swap" rel="stylesheet">
  <style>
    * { box-sizing: border-box; }
    body { margin: 0; background: #f3f5f8; font-family: Inter, sans-serif; }

    /* === Hoja A4 (ajustada para no desbordar en PDF) === */
    .sheet {
      width: 210mm;
      max-height: 297mm;            /* evita segunda hoja */
      margin: 5mm auto;             /* margen externo menor */
      padding: 8mm;                 /* margen interno menor */
      background: #fff;
      border: 2px solid #1a1a1a;
      border-radius: 8px;
      box-shadow: 0 10px 30px rgba(0,0,0,.12);
      overflow: hidden;             /* recorta cualquier fuga */
    }

    /* === Encabezado === */
    .header-wrap { border: 1.6px solid #343a40; border-radius: 6px; overflow: hidden; background:#f2f5f9; }
    .header { display: grid; grid-template-columns: 200px 1fr; align-items: center; }
    .logo-column { border-right: 1.6px solid #343a40; padding: 8px; display:flex; align-items:center; justify-content:center; }
    .logo-img { max-height: 70px !important; width:auto; object-fit:contain; display:block; }
    .title-column { text-align:center; padding: 16px 8px; }
    .title-main { font-family: "Libre Franklin", Inter, sans-serif; font-weight: 700; font-size: 22px; }
    .title-sub { margin-top: 4px; font-weight: 600; font-size: 14px; }

    /* === Cajas con barra de título === */
    .bar-box { margin-top: 8mm; border: 1.4px solid #343a40; border-radius: 6px; overflow: hidden; }
    .bar { display: grid; grid-template-columns: auto 1fr; }
    .bar-label { padding: 6px 10px; background: #e9eef6; font-weight: 700; border-right: 1.4px solid #343a40; }
    .bar-fill { background: #fff; }

    /* === Tablas === */
    table.grid { width: 100% !important; border-collapse: collapse; border-spacing: 0; }
    table.grid th, table.grid td { border: 1px solid #343a40; padding: 6px 7px; font-size: 12.2px; }
    table.grid th { background: #f0f3f8; text-align: left; font-weight: 600; }

    /* Inputs como líneas */
    .input-line { width: 100%; border: none; border-bottom: 1px dashed #7e8790; padding: 2px 0; font: inherit; outline: none; background: transparent; }
    input[type="date"] { width: 100%; border: 1px solid #cfd6df; padding: 3px 6px; border-radius: 4px; font: inherit; }

    /* === Checkboxes: clic sólo en el cuadrado === */
    .checks { padding: 10px; display: grid; gap: 6px; }
    .check { display: grid; grid-template-columns: 16px 1fr; gap: 8px; align-items: center; }
    .check input.cb {
      appearance: none;
      width: 14px; height: 14px; margin: 0; cursor: pointer;
      border: 1.4px solid #343a40; border-radius: 2px; background: #fff;
    }
    .check input.cb:checked { background: #0067c6; }

    /* === Área de notas (GH Pages y PDF coherente) === */
    table.grid.notes { width: 100% !important; table-layout: fixed; }
    table.grid.notes th { width: 100%; }
    table.grid.notes td { padding: 0; }
    textarea {
      width: 100%; display:block; border: none !important; outline: none !important; box-shadow: none !important;
      border-top: 1px dashed #7e8790; padding: 8px 6px; min-height: 22mm; font: inherit; resize: none; overflow: hidden;
      background: transparent;
    }

    /* === Barra de acciones === */
    .toolbar { position: sticky; top: 0; z-index: 10; display:flex; gap:8px; justify-content:center; padding: 10px 0; background: transparent; }
    .btn { background: #0067c6; color:#fff; border:0; border-radius:10px; padding:10px 14px; font-weight:700; cursor:pointer; box-shadow:0 4px 16px rgba(0,103,198,.25); }
    .btn.secondary { background:#6c757d; }

    /* === Print === */
    @media print {
      .toolbar { display: none !important; }
      textarea { min-height: 28mm !important; }
    }
  </style>
</head>
<body>
  <div class="toolbar">
    <button id="btnPdf" class="btn">Convertir a PDF</button>
    <button id="btnClear" class="btn secondary">Limpiar Formulario</button>
  </div>

  <section id="documento" class="sheet">
    <!-- Encabezado principal -->
    <div class="header-wrap">
      <div class="header">
        <div class="logo-column">
          <!-- Ruta relativa (colocar el archivo en /img/logo-para-VPN.png) -->
          <img class="logo-img" src="./logo-para-VPN.png" alt="" crossorigin="anonymous">
        </div>
        <div class="title-column">
          <div class="title-main">Seguridad Informática</div>
          <div class="title-sub">Ministerio de Seguridad - CABA</div>
        </div>
      </div>
    </div>

    <!-- Solicitud de alta de VPN -->
    <div class="bar-box">
      <div class="bar"><div class="bar-label">SOLICITUD DE ALTA DE VPN</div><div class="bar-fill"></div></div>
      <table class="grid">
        <tr>
          <th>Fecha de Solicitud:</th>
          <td><input type="date" placeholder="dd/mm/aaaa"></td>
          <th>Referido a CCOO:</th>
          <td><input class="input-line" type="text"></td>
        </tr>
      </table>
    </div>

    <!-- Datos del solicitante -->
    <div class="bar-box">
      <div class="bar"><div class="bar-label">DATOS DEL SOLICITANTE</div><div class="bar-fill"></div></div>
      <table class="grid">
        <tr><th>Apellido y Nombre</th><td colspan="3"><input class="input-line" type="text"></td></tr>
        <tr><th>Usuario de Dominio</th><td><input class="input-line" type="text"></td><th>Nº de CUIL</th><td><input class="input-line" type="text"></td></tr>
        <tr><th>Cargo</th><td><input class="input-line" type="text"></td><th>LP Nº</th><td><input class="input-line" type="text"></td></tr>
        <tr><th>División / Departamento</th><td colspan="3"><input class="input-line" type="text"></td></tr>
        <tr><th>Dependencia</th><td colspan="3"><input class="input-line" type="text"></td></tr>
        <tr><th>Calle</th><td><input class="input-line" type="text"></td><th>Nº</th><td><input class="input-line" type="text"></td></tr>
        <tr><th>E‑Mail</th><td><input class="input-line" type="email"></td><th>Teléfono / Interno</th><td><input class="input-line" type="text"></td></tr>
      </table>
    </div>

    <!-- Sistemas/Servidores -->
    <div class="bar-box">
      <div class="bar"><div class="bar-label">SISTEMAS O SERVIDORES A LOS CUALES ACCEDERÁ A TRAVÉS DE LA VPN</div><div class="bar-fill"></div></div>
      <div class="checks">
        <div class="check"><input class="cb" type="checkbox"><span>Servicios Policiales <span class="hint">(SIRHU, SILOL, SMLAM, SIGET, SIGENO, SIFOR, CREA, GAP, etc.)</span></span></div>
        <div class="check"><input class="cb" type="checkbox"><span>Servicios ASI <span class="hint">(SADE, SIGAF, SIGAFWEB, BAC, etc.)</span></span></div>
        <div class="check"><input class="cb" type="checkbox"><span>SISEP</span></div>
        <div class="check"><input class="cb" type="checkbox"><span>Cámaras ULTRA‑IP</span></div>
        <div class="check"><input class="cb" type="checkbox"><span>Carpeta Compartida</span></div>
        <div class="check"><input class="cb" type="checkbox"><span>Otros</span></div>
      </div>
      <table class="grid notes">
        <tr><th>Detalle adicional (URLs / Servidores / Observaciones)</th></tr>
        <tr><td><textarea></textarea></td></tr>
      </table>
    </div>

    <!-- Responsable de la dependencia -->
    <div class="bar-box">
      <div class="bar"><div class="bar-label">RESPONSABLE DE LA DEPENDENCIA</div><div class="bar-fill"></div></div>
      <table class="grid">
        <tr><th>Apellido y Nombre</th><td colspan="3"><input class="input-line" type="text"></td></tr>
        <tr><th>Cargo</th><td><input class="input-line" type="text"></td><th>LP</th><td><input class="input-line" type="text"></td></tr>
        <tr><th>División / Departamento</th><td colspan="3"><input class="input-line" type="text"></td></tr>
        <tr><th>E‑Mail</th><td><input class="input-line" type="email"></td><th>Teléfono / Interno</th><td><input class="input-line" type="text"></td></tr>
      </table>
    </div>
  </section>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.9.3/html2pdf.bundle.min.js"></script>
  <script>
    // Pre-carga del logo con fallback si no existe
    (function(){
      const target = document.querySelector('.logo-img');
      if(!target) return;
      const test = new Image();
      test.crossOrigin = 'anonymous';
      test.onload = () => { target.src = test.src; };
      test.onerror = () => { console.warn('Logo no encontrado, se oculta en pantalla y en PDF'); target.style.display = 'none'; };
      // Mantené la misma ruta que en el src del <img>
      test.src = target.getAttribute('src');
    })();

    // Descargar PDF (versión simple, robusta)
    document.getElementById('btnPdf').addEventListener('click', () => {
      const el = document.getElementById('documento');
      const opt = {
        margin: 0,
        filename: 'Solicitud_Alta_VPN.pdf',
        image: { type: 'jpeg', quality: 0.98 },
        html2canvas: { scale: 2, useCORS: true, imageTimeout: 15000 },
        jsPDF: { unit: 'mm', format: 'a4', orientation: 'portrait' },
        pagebreak: { mode: ['avoid-all','css','legacy'] }
      };
      try {
        html2pdf().set(opt).from(el).save();
      } catch (e) {
        console.error('Error al generar PDF:', e);
        alert('No pude generar el PDF. Probá recargar la página.');
      }
    });

    // Limpiar formulario
    document.getElementById('btnClear').addEventListener('click', () => {
      document.querySelectorAll('input, textarea').forEach(el => {
        if (el.type === 'checkbox' || el.type === 'radio') el.checked = false;
        else el.value = '';
      });
    });
  </script>
</body>
</html>

